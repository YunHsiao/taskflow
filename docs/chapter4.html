<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cookbook &raquo; Conditional Tasking | Taskflow QuickStart</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://taskflow.github.io"><img src="taskflow_logo.png" alt="" />Taskflow</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">QuickStart</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Handbook</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="Cookbook.html">Cookbook</a> &raquo;</span>
          Conditional Tasking
        </h1>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#C4_CreateAConditionTask">Create a Condition Task</a></li>
            <li>
              <a href="#C4_TaskSchedulingPolicy">Understand our Task-level Scheduling</a>
              <ul>
                <li><a href="#TaskLevelSchedulingExample">Example</a></li>
              </ul>
            </li>
            <li><a href="#C4_AvoidCommonPitfalls">Avoid Common Pitfalls</a></li>
          </ul>
        </div>
<p>Parallel workloads often require making control-flow decisions across dependent tasks. Taskflow supports an very efficient interface of conditional tasking for users to implement general control flow such as dynamic flow, cycles, and conditionals that are otherwise difficult to do with existing frameworks.</p><section id="C4_CreateAConditionTask"><h2><a href="#C4_CreateAConditionTask">Create a Condition Task</a></h2><p>A condition task evalutes a set of instructions and returns an integer index of the next immediate successor to execute. The index is defined with respect to the order of its successor construction.</p><pre class="m-code"> <span class="mi">1</span><span class="o">:</span> <span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span> <span class="n">taskflow</span><span class="p">;</span>
 <span class="mi">2</span><span class="o">:</span> 
 <span class="mi">3</span><span class="o">:</span> <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">init</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">);</span>
 <span class="mi">4</span><span class="o">:</span> <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;stop&quot;</span><span class="p">);</span>
 <span class="mi">5</span><span class="o">:</span>
 <span class="mi">6</span><span class="o">:</span> <span class="c1">// creates a condition task that returns 0 or 1</span>
 <span class="mi">7</span><span class="o">:</span> <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span>
 <span class="mi">8</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;flipping a coin</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
 <span class="mi">9</span><span class="o">:</span>  <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="p">;</span>
<span class="mi">10</span><span class="o">:</span> <span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cond&quot;</span><span class="p">);</span>
<span class="mi">11</span><span class="o">:</span>
<span class="mi">12</span><span class="o">:</span> <span class="c1">// creates a feedback loop {0: cond, 1: stop}</span>
<span class="mi">13</span><span class="o">:</span> <span class="n">init</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span>
<span class="mi">14</span><span class="o">:</span> <span class="n">cond</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">stop</span><span class="p">);</span>  <span class="c1">// returns 0 to &#39;cond&#39; or 1 to &#39;stop&#39;</span>
<span class="mi">15</span><span class="o">:</span>
<span class="mi">16</span><span class="o">:</span> <span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span></pre><div class="m-graph"><svg style="width: 18.875rem; height: 4.875rem;" viewBox="0.00 0.00 302.13 78.00">
<g transform="scale(1 1) rotate(0) translate(4 74)">
<title>Taskflow</title>
<g class="m-node">
<title>cond</title>
<polygon points="139.0938,-36 90.906,-18 139.0938,0 187.2816,-18 139.0938,-36"/>
<text text-anchor="middle" x="139.0938" y="-13.2">cond</text>
</g>
<g class="m-edge">
<title>cond&#45;&gt;cond</title>
<path stroke-dasharray="5,2" d="M128.317,-32.0417C124.2867,-42.9126 127.879,-54 139.0938,-54 146.804,-54 150.9113,-48.7595 151.4158,-41.9516"/>
<polygon points="154.8695,-41.3831 149.8706,-32.0417 147.9531,-42.4616 154.8695,-41.3831"/>
<text text-anchor="middle" x="139.0938" y="-57.2">0</text>
</g>
<g class="m-node m-flat">
<title>stop</title>
<ellipse cx="263.1062" cy="-18" rx="31.0404" ry="18"/>
<text text-anchor="middle" x="263.1062" y="-13.2">stop</text>
</g>
<g class="m-edge">
<title>cond&#45;&gt;stop</title>
<path stroke-dasharray="5,2" d="M187.3953,-18C198.7337,-18 210.7157,-18 221.7198,-18"/>
<polygon points="221.9178,-21.5001 231.9177,-18 221.9177,-14.5001 221.9178,-21.5001"/>
<text text-anchor="middle" x="209.6368" y="-21.2">1</text>
</g>
<g class="m-node m-flat">
<title>init</title>
<ellipse cx="27" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="27" y="-13.2">init</text>
</g>
<g class="m-edge">
<title>init&#45;&gt;cond</title>
<path d="M54.1348,-18C62.2239,-18 71.4195,-18 80.701,-18"/>
<polygon points="80.7579,-21.5001 90.7579,-18 80.7578,-14.5001 80.7579,-21.5001"/>
</g>
</g>
</svg>
</div><p>The example above implements a simple yet commonly used feedback loop through a condition task (line 7-10) that returns a random binary value. If the return value from <code>cond</code> is <code>0</code>, it loops back to itself, or otherwise to <code>stop</code>. Our conditional tasking interface is very neat and expressive. A complex flow control often just takes a few lines of code to implement. The code below creates another taskflow with three condition tasks.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span> <span class="n">taskflow</span><span class="p">;</span>

<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">A</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">B</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;B&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">C</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">D</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;D&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">E</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;E&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">F</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;F&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">G</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;G&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">H</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;H&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">I</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;I&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">K</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">L</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">M</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;M&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">cond_1</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span> <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span> <span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cond_1&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">cond_2</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span> <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span> <span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cond_2&quot;</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">cond_3</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span> <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span> <span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cond_3&quot;</span><span class="p">);</span>

<span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">F</span><span class="p">);</span>
<span class="n">B</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">C</span><span class="p">);</span>
<span class="n">C</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">D</span><span class="p">);</span>
<span class="n">D</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond_1</span><span class="p">);</span>
<span class="n">E</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">K</span><span class="p">);</span>
<span class="n">F</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond_2</span><span class="p">);</span>
<span class="n">H</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
<span class="n">I</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond_3</span><span class="p">);</span>
<span class="n">L</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">M</span><span class="p">);</span>

<span class="n">cond_1</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">E</span><span class="p">);</span>       <span class="c1">// return 0 to &#39;B&#39; or 1 to &#39;E&#39;</span>
<span class="n">cond_2</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">H</span><span class="p">);</span>       <span class="c1">// return 0 to &#39;G&#39; or 1 to &#39;H&#39;</span>
<span class="n">cond_3</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond_3</span><span class="p">,</span> <span class="n">L</span><span class="p">);</span>  <span class="c1">// return 0 to &#39;cond_3&#39; or 1 to &#39;L&#39;</span>

<span class="n">taskflow</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">);</span></pre><p>The above code creates three condition tasks: (1) a condition task <code>cond_1</code> that loops back to <code>B</code> on returning <code>0</code>, or proceeds to <code>E</code> on returning <code>1</code>, (2) a condition task <code>cond_2</code> that goes to <code>G</code> on returning <code>0</code>, or <code>H</code> on returning <code>1</code>, (3) a condition task <code>cond_3</code> that loops back to itself on returning <code>0</code>, or proceeds to <code>L</code> on returning <code>1</code></p><div class="m-graph"><svg style="width: 59.438rem; height: 12.000rem;" viewBox="0.00 0.00 950.56 192.00">
<g transform="scale(1 1) rotate(0) translate(4 188)">
<title>Taskflow</title>
<g class="m-node m-flat">
<title>p0x7fecbdc02830</title>
<ellipse cx="27" cy="-94" rx="27" ry="18"/>
<text text-anchor="middle" x="27" y="-89.2">A</text>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc02940</title>
<ellipse cx="118" cy="-122" rx="27" ry="18"/>
<text text-anchor="middle" x="118" y="-117.2">B</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc02830&#45;&gt;p0x7fecbdc02940</title>
<path d="M51.8661,-101.6511C61.6764,-104.6697 73.1102,-108.1878 83.6848,-111.4415"/>
<polygon points="82.8919,-114.8594 93.479,-114.4551 84.9505,-108.1689 82.8919,-114.8594"/>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc02d80</title>
<ellipse cx="118" cy="-68" rx="27" ry="18"/>
<text text-anchor="middle" x="118" y="-63.2">F</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc02830&#45;&gt;p0x7fecbdc02d80</title>
<path d="M51.8661,-86.8954C61.5966,-84.1152 72.9244,-80.8787 83.4267,-77.8781"/>
<polygon points="84.5102,-81.2086 93.1639,-75.096 82.5871,-74.478 84.5102,-81.2086"/>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc02a50</title>
<ellipse cx="246.9774" cy="-166" rx="27" ry="18"/>
<text text-anchor="middle" x="246.9774" y="-161.2">C</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc02940&#45;&gt;p0x7fecbdc02a50</title>
<path d="M142.2597,-130.2761C162.2562,-137.0978 190.845,-146.8507 213.1004,-154.443"/>
<polygon points="212.232,-157.8448 222.8265,-157.761 214.4922,-151.2197 212.232,-157.8448"/>
</g>
<g class="m-node">
<title>p0x7fecbdc03600</title>
<polygon points="246.9774,-86 182.0226,-68 246.9774,-50 311.9322,-68 246.9774,-86"/>
<text text-anchor="middle" x="246.9774" y="-63.2">cond_2</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc02d80&#45;&gt;p0x7fecbdc03600</title>
<path d="M145.0379,-68C153.097,-68 162.3502,-68 171.9228,-68"/>
<polygon points="171.9773,-71.5001 181.9773,-68 171.9772,-64.5001 171.9773,-71.5001"/>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc02b60</title>
<ellipse cx="383.8532" cy="-166" rx="27" ry="18"/>
<text text-anchor="middle" x="383.8532" y="-161.2">D</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc02a50&#45;&gt;p0x7fecbdc02b60</title>
<path d="M274.0197,-166C294.6937,-166 323.4408,-166 346.3393,-166"/>
<polygon points="346.3987,-169.5001 356.3986,-166 346.3986,-162.5001 346.3987,-169.5001"/>
</g>
<g class="m-node">
<title>p0x7fecbdc034f0</title>
<polygon points="512.8306,-155 447.8758,-137 512.8306,-119 577.7854,-137 512.8306,-155"/>
<text text-anchor="middle" x="512.8306" y="-132.2">cond_1</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc02b60&#45;&gt;p0x7fecbdc034f0</title>
<path d="M409.6437,-160.2011C426.0453,-156.5133 447.7464,-151.6339 467.014,-147.3017"/>
<polygon points="467.8383,-150.7038 476.8269,-145.0953 466.3026,-143.8743 467.8383,-150.7038"/>
</g>
<g class="m-edge">
<title>p0x7fecbdc034f0&#45;&gt;p0x7fecbdc02940</title>
<path stroke-dasharray="5,2" d="M455.3875,-134.8177C373.1784,-131.6945 224.2807,-126.0377 155.1365,-123.4109"/>
<polygon points="155.264,-119.9133 145.1383,-123.031 154.9982,-126.9082 155.264,-119.9133"/>
<text text-anchor="middle" x="334.404" y="-133.2">0</text>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc02c70</title>
<ellipse cx="687.6838" cy="-137" rx="27" ry="18"/>
<text text-anchor="middle" x="687.6838" y="-132.2">E</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc034f0&#45;&gt;p0x7fecbdc02c70</title>
<path stroke-dasharray="5,2" d="M577.9395,-137C602.36,-137 629.2701,-137 650.3313,-137"/>
<polygon points="650.465,-140.5001 660.465,-137 650.465,-133.5001 650.465,-140.5001"/>
<text text-anchor="middle" x="600.2572" y="-140.2">1</text>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc031c0</title>
<ellipse cx="824.5597" cy="-137" rx="27" ry="18"/>
<text text-anchor="middle" x="824.5597" y="-132.2">K</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc02c70&#45;&gt;p0x7fecbdc031c0</title>
<path d="M714.7261,-137C735.4002,-137 764.1472,-137 787.0457,-137"/>
<polygon points="787.1051,-140.5001 797.1051,-137 787.1051,-133.5001 787.1051,-140.5001"/>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc02e90</title>
<ellipse cx="383.8532" cy="-72" rx="27" ry="18"/>
<text text-anchor="middle" x="383.8532" y="-67.2">G</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc03600&#45;&gt;p0x7fecbdc02e90</title>
<path stroke-dasharray="5,2" d="M305.8194,-69.7196C319.6316,-70.1232 333.9757,-70.5424 346.541,-70.9096"/>
<polygon points="346.5288,-74.4106 356.6268,-71.2043 346.7334,-67.4136 346.5288,-74.4106"/>
<text text-anchor="middle" x="334.404" y="-73.2">0</text>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc02fa0</title>
<ellipse cx="383.8532" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="383.8532" y="-13.2">H</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc03600&#45;&gt;p0x7fecbdc02fa0</title>
<path stroke-dasharray="5,2" d="M275.0066,-57.7611C296.9061,-49.7613 327.406,-38.6199 350.5501,-30.1654"/>
<polygon points="351.7802,-33.4424 359.9722,-26.7236 349.3783,-26.8674 351.7802,-33.4424"/>
<text text-anchor="middle" x="334.404" y="-40.2">1</text>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc030b0</title>
<ellipse cx="512.8306" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="512.8306" y="-13.2">I</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc02fa0&#45;&gt;p0x7fecbdc030b0</title>
<path d="M410.8911,-18C429.7222,-18 455.0732,-18 475.7829,-18"/>
<polygon points="475.8284,-21.5001 485.8283,-18 475.8283,-14.5001 475.8284,-21.5001"/>
</g>
<g class="m-node">
<title>p0x7fecbdc03710</title>
<polygon points="687.6838,-36 622.7291,-18 687.6838,0 752.6386,-18 687.6838,-36"/>
<text text-anchor="middle" x="687.6838" y="-13.2">cond_3</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc030b0&#45;&gt;p0x7fecbdc03710</title>
<path d="M540.1514,-18C559.5692,-18 586.6542,-18 612.3242,-18"/>
<polygon points="612.4507,-21.5001 622.4507,-18 612.4506,-14.5001 612.4507,-21.5001"/>
</g>
<g class="m-edge">
<title>p0x7fecbdc03710&#45;&gt;p0x7fecbdc03710</title>
<path stroke-dasharray="5,2" d="M673.4642,-32.4167C668.4987,-43.166 673.2385,-54 687.6838,-54 697.3893,-54 702.7135,-49.1094 703.6566,-42.6397"/>
<polygon points="707.0434,-41.6812 701.9035,-32.4167 700.1441,-42.8644 707.0434,-41.6812"/>
<text text-anchor="middle" x="687.6838" y="-57.2">0</text>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc032d0</title>
<ellipse cx="824.5597" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="824.5597" y="-13.2">L</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc03710&#45;&gt;p0x7fecbdc032d0</title>
<path stroke-dasharray="5,2" d="M752.9148,-18C764.689,-18 776.5901,-18 787.2199,-18"/>
<polygon points="787.3743,-21.5001 797.3742,-18 787.3742,-14.5001 787.3743,-21.5001"/>
<text text-anchor="middle" x="775.1105" y="-21.2">1</text>
</g>
<g class="m-node m-flat">
<title>p0x7fecbdc033e0</title>
<ellipse cx="915.5597" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="915.5597" y="-13.2">M</text>
</g>
<g class="m-edge">
<title>p0x7fecbdc032d0&#45;&gt;p0x7fecbdc033e0</title>
<path d="M851.8627,-18C860.141,-18 869.3814,-18 878.2002,-18"/>
<polygon points="878.276,-21.5001 888.2759,-18 878.2759,-14.5001 878.276,-21.5001"/>
</g>
</g>
</svg>
</div><p>You can use condition tasks to create cycles as long as the graph does not introduce task race during execution. However, cycles are not allowed in non-condition tasks.</p></section><section id="C4_TaskSchedulingPolicy"><h2><a href="#C4_TaskSchedulingPolicy">Understand our Task-level Scheduling</a></h2><p>In order to understand how an executor schedules condition tasks, we define two dependency types, <em>strong dependency</em> and <em>weak dependency</em>. A strong dependency is a preceding link from a non-condition task to another task. A weak dependency is a preceding link from a condition task to another task. The number of dependents of a task is the sum of strong dependency and weak dependency. The table below lists the strong dependency and weak dependency numbers of each task in the previous example.</p><table class="m-table"><thead><tr><th>task</th><th>strong dependency</th><th>weak dependency</th><th>dependents</th></tr></thead><tbody><tr><td>A</td><td>0</td><td>0</td><td>0</td></tr><tr><td>B</td><td>1</td><td>1</td><td>2</td></tr><tr><td>C</td><td>1</td><td>0</td><td>1</td></tr><tr><td>D</td><td>1</td><td>0</td><td>1</td></tr><tr><td>E</td><td>0</td><td>1</td><td>1</td></tr><tr><td>F</td><td>1</td><td>0</td><td>1</td></tr><tr><td>G</td><td>0</td><td>1</td><td>1</td></tr><tr><td>H</td><td>0</td><td>1</td><td>1</td></tr><tr><td>I</td><td>1</td><td>0</td><td>1</td></tr><tr><td>K</td><td>1</td><td>0</td><td>1</td></tr><tr><td>L</td><td>0</td><td>1</td><td>1</td></tr><tr><td>M</td><td>1</td><td>0</td><td>1</td></tr><tr><td>cond_1</td><td>1</td><td>0</td><td>1</td></tr><tr><td>cond_2</td><td>1</td><td>0</td><td>1</td></tr><tr><td>cond_3</td><td>1</td><td>1</td><td>2</td></tr></tbody></table><p>You can query the number of strong dependents, the number of weak dependents, and the number of dependents of a task.</p><pre class="m-code"><span class="mi">1</span><span class="o">:</span> <span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span> <span class="n">taskflow</span><span class="p">;</span>
<span class="mi">2</span><span class="o">:</span> 
<span class="mi">3</span><span class="o">:</span> <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">task</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){});</span>
<span class="mi">4</span><span class="o">:</span> 
<span class="mi">5</span><span class="o">:</span> <span class="c1">// ... add more tasks and preceding links</span>
<span class="mi">6</span><span class="o">:</span>
<span class="mi">7</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">task</span><span class="p">.</span><span class="n">num_dependents</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="mi">8</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">task</span><span class="p">.</span><span class="n">num_strong_dependents</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span> 
<span class="mi">9</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">task</span><span class="p">.</span><span class="n">num_weak_dependents</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span></pre><p>When you submit a task to an executor, the scheduler starts with tasks of <em>zero dependents</em> (both zero strong and weak dependencies) and continues to execute successive tasks whenever their <em>strong dependencies</em> are met. However, the scheduler skips this rule when executing a condition task and jumps directly to its successors indexed by the return value.</p><div class="m-graph"><svg style="width: 61.125rem; height: 21.938rem;" viewBox="0.00 0.00 978.13 351.00">
<g transform="scale(1 1) rotate(0) translate(4 347)">
<title>G</title>
<g class="m-node m-flat">
<title>atask</title>
<ellipse cx="599.8666" cy="-325" rx="48.9376" ry="18"/>
<text text-anchor="middle" x="599.8666" y="-320.2">a task T</text>
</g>
<g class="m-node">
<title>cond</title>
<polygon points="599.8666,-270 442.4074,-252 599.8666,-234 757.3258,-252 599.8666,-270"/>
<text text-anchor="middle" x="599.8666" y="-247.2">is T a condition task?</text>
</g>
<g class="m-edge">
<title>atask&#45;&gt;cond</title>
<path d="M599.8666,-306.9551C599.8666,-298.8828 599.8666,-289.1764 599.8666,-280.1817"/>
<polygon points="603.3667,-280.0903 599.8666,-270.0904 596.3667,-280.0904 603.3667,-280.0903"/>
</g>
<g class="m-node m-flat">
<title>invokeN</title>
<ellipse cx="525.8666" cy="-164" rx="55.4265" ry="18"/>
<text text-anchor="middle" x="525.8666" y="-159.2">invoke(T)</text>
</g>
<g class="m-edge">
<title>cond&#45;&gt;invokeN</title>
<path stroke-dasharray="5,2" d="M585.9478,-235.4479C574.9969,-222.4252 559.5547,-204.0615 547.0681,-189.2126"/>
<polygon points="549.5973,-186.7821 540.4825,-181.381 544.2397,-191.2873 549.5973,-186.7821"/>
<text text-anchor="middle" x="578.7651" y="-203.2">no</text>
</g>
<g class="m-node m-flat">
<title>invokeY</title>
<ellipse cx="760.8666" cy="-164" rx="75.3927" ry="18"/>
<text text-anchor="middle" x="760.8666" y="-159.2">R = invoke(T)</text>
</g>
<g class="m-edge">
<title>cond&#45;&gt;invokeY</title>
<path stroke-dasharray="5,2" d="M627.1781,-237.072C653.0832,-222.9127 692.2897,-201.483 721.5552,-185.487"/>
<polygon points="723.5821,-188.3679 730.6782,-180.5005 720.2248,-182.2255 723.5821,-188.3679"/>
<text text-anchor="middle" x="707.3158" y="-203.2">yes</text>
</g>
<g class="m-node m-flat">
<title>decrement</title>
<ellipse cx="309.8666" cy="-91" rx="309.7333" ry="18"/>
<text text-anchor="middle" x="309.8666" y="-86.2">decrement strong dependencies of each successor of T by one</text>
</g>
<g class="m-edge">
<title>invokeN&#45;&gt;decrement</title>
<path d="M487.2501,-150.9491C455.392,-140.1822 409.5655,-124.6945 372.4724,-112.1584"/>
<polygon points="373.3479,-108.7599 362.7537,-108.8739 371.1066,-115.3914 373.3479,-108.7599"/>
</g>
<g class="m-node m-flat">
<title>enqueueR</title>
<ellipse cx="803.8666" cy="-91" rx="166.0176" ry="18"/>
<text text-anchor="middle" x="803.8666" y="-86.2">enqueue the R&#45;th successor of T</text>
</g>
<g class="m-edge">
<title>invokeY&#45;&gt;enqueueR</title>
<path d="M771.4958,-145.9551C776.5091,-137.4441 782.5925,-127.1165 788.1263,-117.7219"/>
<polygon points="791.151,-119.4831 793.2106,-109.0904 785.1195,-115.9303 791.151,-119.4831"/>
</g>
<g class="m-node m-flat">
<title>enqueueS</title>
<ellipse cx="309.8666" cy="-18" rx="241.7843" ry="18"/>
<text text-anchor="middle" x="309.8666" y="-13.2">enqueue successors of zero strong dpendencies</text>
</g>
<g class="m-edge">
<title>decrement&#45;&gt;enqueueS</title>
<path d="M309.8666,-72.9551C309.8666,-64.8828 309.8666,-55.1764 309.8666,-46.1817"/>
<polygon points="313.3667,-46.0903 309.8666,-36.0904 306.3667,-46.0904 313.3667,-46.0903"/>
</g>
</g>
</svg>
</div><p>Each task has an <em>atomic</em> join counter to keep track of strong dependents that are met at runtime. When a task completes, the join counter is restored to the task&#x27;s strong dependency number in the graph, such that the subsequent execution can reuse the counter again.</p><section id="TaskLevelSchedulingExample"><h3><a href="#TaskLevelSchedulingExample">Example</a></h3><p>Let&#x27;s take a look at an example to understand how task-level scheduling works. Suppose we have the following taskflow of one condition task <code>cond</code> that forms a loop to itself on returning <code>0</code> and moves on to <code>stop</code> on returning <code>1</code>:</p><div class="m-graph"><svg style="width: 18.875rem; height: 4.875rem;" viewBox="0.00 0.00 302.13 78.00">
<g transform="scale(1 1) rotate(0) translate(4 74)">
<title>Taskflow</title>
<g class="m-node">
<title>cond</title>
<polygon points="139.0938,-36 90.906,-18 139.0938,0 187.2816,-18 139.0938,-36"/>
<text text-anchor="middle" x="139.0938" y="-13.2">cond</text>
</g>
<g class="m-edge">
<title>cond&#45;&gt;cond</title>
<path stroke-dasharray="5,2" d="M128.317,-32.0417C124.2867,-42.9126 127.879,-54 139.0938,-54 146.804,-54 150.9113,-48.7595 151.4158,-41.9516"/>
<polygon points="154.8695,-41.3831 149.8706,-32.0417 147.9531,-42.4616 154.8695,-41.3831"/>
<text text-anchor="middle" x="139.0938" y="-57.2">0</text>
</g>
<g class="m-node m-flat">
<title>stop</title>
<ellipse cx="263.1062" cy="-18" rx="31.0404" ry="18"/>
<text text-anchor="middle" x="263.1062" y="-13.2">stop</text>
</g>
<g class="m-edge">
<title>cond&#45;&gt;stop</title>
<path stroke-dasharray="5,2" d="M187.3953,-18C198.7337,-18 210.7157,-18 221.7198,-18"/>
<polygon points="221.9178,-21.5001 231.9177,-18 221.9177,-14.5001 221.9178,-21.5001"/>
<text text-anchor="middle" x="209.6368" y="-21.2">1</text>
</g>
<g class="m-node m-flat">
<title>init</title>
<ellipse cx="27" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="27" y="-13.2">init</text>
</g>
<g class="m-edge">
<title>init&#45;&gt;cond</title>
<path d="M54.1348,-18C62.2239,-18 71.4195,-18 80.701,-18"/>
<polygon points="80.7579,-21.5001 90.7579,-18 80.7578,-14.5001 80.7579,-21.5001"/>
</g>
</g>
</svg>
</div><p>The scheduler starts with <code>init</code> task because it has no dependencies (both strong and weak dependencies). Then, the scheduler moves on to the condition task <code>cond</code>. If <code>cond</code> returns <code>0</code>, the scheduler enqueues <code>cond</code> and runs it again. If <code>cond</code> returns <code>1</code>, the scheduler enqueues <code>stop</code> and then moves on.</p></section></section><section id="C4_AvoidCommonPitfalls"><h2><a href="#C4_AvoidCommonPitfalls">Avoid Common Pitfalls</a></h2><p>Condition tasks are handy in creasing dynamic and cyclic control flows, but they are also easy to make mistakes. It is your responsibility to ensure a taskflow is properly conditioned. Top things to avoid include <em>no source tasks</em> to start with and <em>task race</em>. The figure below shows common pitfalls and their remedies.</p><div class="m-graph"><svg style="width: 61.188rem; height: 22.000rem;" viewBox="0.00 0.00 979.00 352.00">
<g transform="scale(1 1) rotate(0) translate(4 348)">
<title>Taskflow</title>
<g class="m-cluster">
<title>cluster_error1</title>
<polygon points="8,-134 8,-336 187,-336 187,-134 8,-134"/>
<text text-anchor="middle" x="97.5" y="-319.2">error1: no source tasks</text>
</g>
<g class="m-cluster">
<title>cluster_fix1</title>
<polygon points="195,-8 195,-336 345,-336 345,-8 195,-8"/>
<text text-anchor="middle" x="270" y="-319.2">fix1: adds a source</text>
</g>
<g class="m-cluster">
<title>cluster_error2</title>
<polygon points="353,-134 353,-336 495,-336 495,-134 353,-134"/>
<text text-anchor="middle" x="424" y="-319.2">error2: race on D</text>
</g>
<g class="m-cluster">
<title>cluster_fix2</title>
<polygon points="503,-8 503,-336 741,-336 741,-8 503,-8"/>
<text text-anchor="middle" x="622" y="-319.2">fix2: adds an auxiliary task</text>
</g>
<g class="m-cluster">
<title>cluster_risky</title>
<polygon points="749,-134 749,-336 963,-336 963,-134 749,-134"/>
<text text-anchor="middle" x="856" y="-319.2">risky: X might be raced</text>
</g>
<g class="m-node">
<title>e1A</title>
<polygon points="65,-304 38,-286 65,-268 92,-286 65,-304"/>
<text text-anchor="middle" x="65" y="-281.2">A</text>
</g>
<g class="m-edge">
<title>e1A&#45;&gt;e1A</title>
<path stroke-dasharray="5,2" d="M83.4896,-292.0233C96.7706,-293.9843 110,-291.9766 110,-286 110,-281.5643 102.7127,-279.3147 93.5255,-279.2514"/>
<polygon points="93.2112,-275.7649 83.4896,-279.9767 93.7159,-282.7467 93.2112,-275.7649"/>
<text text-anchor="middle" x="114.4492" y="-281.2">0</text>
</g>
<g class="m-node m-flat">
<title>e1B</title>
<ellipse cx="54" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="54" y="-155.2">B</text>
</g>
<g class="m-edge">
<title>e1A&#45;&gt;e1B</title>
<path stroke-dasharray="5,2" d="M63.4936,-268.7444C61.6894,-248.0782 58.6413,-213.1635 56.4862,-188.4784"/>
<polygon points="59.9516,-187.9287 55.5951,-178.271 52.9781,-188.5375 59.9516,-187.9287"/>
<text text-anchor="middle" x="64.4492" y="-218.2">1</text>
</g>
<g class="m-node m-flat">
<title>e1C</title>
<ellipse cx="126" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="126" y="-155.2">C</text>
</g>
<g class="m-edge">
<title>e1A&#45;&gt;e1C</title>
<path stroke-dasharray="5,2" d="M71.7611,-272.0344C81.7182,-251.4673 100.509,-212.6535 113.1435,-186.5561"/>
<polygon points="116.4458,-187.767 117.6531,-177.2412 110.1453,-184.7167 116.4458,-187.767"/>
<text text-anchor="middle" x="102.4492" y="-218.2">2</text>
</g>
<g class="m-node m-flat">
<title>f1S</title>
<ellipse cx="252" cy="-286" rx="27" ry="18"/>
<text text-anchor="middle" x="252" y="-281.2">S</text>
</g>
<g class="m-node">
<title>f1A</title>
<polygon points="252,-178 225,-160 252,-142 279,-160 252,-178"/>
<text text-anchor="middle" x="252" y="-155.2">A</text>
</g>
<g class="m-edge">
<title>f1S&#45;&gt;f1A</title>
<path d="M252,-267.9473C252,-247.0823 252,-212.4928 252,-188.1006"/>
<polygon points="255.5001,-188.0192 252,-178.0192 248.5001,-188.0193 255.5001,-188.0192"/>
</g>
<g class="m-edge">
<title>f1A&#45;&gt;f1A</title>
<path stroke-dasharray="5,2" d="M270.4896,-166.0233C283.7706,-167.9843 297,-165.9766 297,-160 297,-155.5643 289.7127,-153.3147 280.5255,-153.2514"/>
<polygon points="280.2112,-149.7649 270.4896,-153.9767 280.7159,-156.7467 280.2112,-149.7649"/>
<text text-anchor="middle" x="301.4492" y="-155.2">0</text>
</g>
<g class="m-node m-flat">
<title>f1B</title>
<ellipse cx="234" cy="-34" rx="27" ry="18"/>
<text text-anchor="middle" x="234" y="-29.2">B</text>
</g>
<g class="m-edge">
<title>f1A&#45;&gt;f1B</title>
<path stroke-dasharray="5,2" d="M249.6468,-143.5277C246.695,-122.8653 241.588,-87.1163 238.0139,-62.0974"/>
<polygon points="241.4659,-61.5117 236.5867,-52.1072 234.5362,-62.5017 241.4659,-61.5117"/>
<text text-anchor="middle" x="247.4492" y="-92.2">1</text>
</g>
<g class="m-node m-flat">
<title>f1C</title>
<ellipse cx="306" cy="-34" rx="27" ry="18"/>
<text text-anchor="middle" x="306" y="-29.2">C</text>
</g>
<g class="m-edge">
<title>f1A&#45;&gt;f1C</title>
<path stroke-dasharray="5,2" d="M258.1945,-145.5462C267.0379,-124.9116 283.437,-86.6471 294.5326,-60.7573"/>
<polygon points="297.7764,-62.0734 298.4986,-51.5032 291.3424,-59.3159 297.7764,-62.0734"/>
<text text-anchor="middle" x="285.4492" y="-92.2">2</text>
</g>
<g class="m-node">
<title>e2C</title>
<polygon points="460,-304 433,-286 460,-268 487,-286 460,-304"/>
<text text-anchor="middle" x="460" y="-281.2">C</text>
</g>
<g class="m-node m-flat">
<title>e2D</title>
<ellipse cx="388" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="388" y="-155.2">D</text>
</g>
<g class="m-edge">
<title>e2C&#45;&gt;e2D</title>
<path stroke-dasharray="5,2" d="M452.2947,-272.5158C440.5341,-251.9346 417.8899,-212.3072 402.8596,-186.0043"/>
<polygon points="405.7012,-183.9225 397.7009,-176.9766 399.6235,-187.3955 405.7012,-183.9225"/>
<text text-anchor="middle" x="431.4492" y="-218.2">0</text>
</g>
<g class="m-node m-flat">
<title>e2F</title>
<ellipse cx="460" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="460" y="-155.2">F</text>
</g>
<g class="m-edge">
<title>e2C&#45;&gt;e2F</title>
<path stroke-dasharray="5,2" d="M460,-267.9473C460,-247.0823 460,-212.4928 460,-188.1006"/>
<polygon points="463.5001,-188.0192 460,-178.0192 456.5001,-188.0193 463.5001,-188.0192"/>
<text text-anchor="middle" x="464.4492" y="-218.2">1</text>
</g>
<g class="m-node m-flat">
<title>e2E</title>
<ellipse cx="388" cy="-286" rx="27" ry="18"/>
<text text-anchor="middle" x="388" y="-281.2">E</text>
</g>
<g class="m-edge">
<title>e2E&#45;&gt;e2D</title>
<path d="M388,-267.9473C388,-247.0823 388,-212.4928 388,-188.1006"/>
<polygon points="391.5001,-188.0192 388,-178.0192 384.5001,-188.0193 391.5001,-188.0192"/>
</g>
<g class="m-node">
<title>f2C</title>
<polygon points="664,-304 637,-286 664,-268 691,-286 664,-304"/>
<text text-anchor="middle" x="664" y="-281.2">C</text>
</g>
<g class="m-node m-flat">
<title>f2Daux</title>
<ellipse cx="622" cy="-160" rx="39.2275" ry="18"/>
<text text-anchor="middle" x="622" y="-155.2">D&#45;aux</text>
</g>
<g class="m-edge">
<title>f2C&#45;&gt;f2Daux</title>
<path stroke-dasharray="5,2" d="M659.0171,-271.0514C652.188,-250.5641 639.7951,-213.3854 631.242,-187.7261"/>
<polygon points="634.5436,-186.5627 628.0609,-178.1827 627.9029,-188.7764 634.5436,-186.5627"/>
<text text-anchor="middle" x="649.4492" y="-218.2">0</text>
</g>
<g class="m-node m-flat">
<title>f2F</title>
<ellipse cx="706" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="706" y="-155.2">F</text>
</g>
<g class="m-edge">
<title>f2C&#45;&gt;f2F</title>
<path stroke-dasharray="5,2" d="M668.9829,-271.0514C675.8503,-250.449 688.3443,-212.9672 696.9018,-187.2947"/>
<polygon points="700.2372,-188.3562 700.0791,-177.7626 693.5964,-186.1426 700.2372,-188.3562"/>
<text text-anchor="middle" x="691.4492" y="-218.2">1</text>
</g>
<g class="m-node m-flat">
<title>f2D</title>
<ellipse cx="580" cy="-34" rx="27" ry="18"/>
<text text-anchor="middle" x="580" y="-29.2">D</text>
</g>
<g class="m-edge">
<title>f2Daux&#45;&gt;f2D</title>
<path d="M615.9824,-141.9473C608.9566,-120.8697 597.2621,-85.7863 589.1193,-61.358"/>
<polygon points="592.3537,-59.993 585.871,-51.613 585.713,-62.2067 592.3537,-59.993"/>
</g>
<g class="m-node m-flat">
<title>f2E</title>
<ellipse cx="538" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="538" y="-155.2">E</text>
</g>
<g class="m-edge">
<title>f2E&#45;&gt;f2D</title>
<path d="M543.9285,-142.2145C550.9326,-121.2023 562.6642,-86.0074 570.8397,-61.4808"/>
<polygon points="574.2597,-62.2887 574.1017,-51.695 567.6189,-60.075 574.2597,-62.2887"/>
</g>
<g class="m-node">
<title>rP</title>
<polygon points="906,-304 879,-286 906,-268 933,-286 906,-304"/>
<text text-anchor="middle" x="906" y="-281.2">P</text>
</g>
<g class="m-node m-flat">
<title>rQ</title>
<ellipse cx="928" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="928" y="-155.2">Q</text>
</g>
<g class="m-edge">
<title>rP&#45;&gt;rQ</title>
<path stroke-dasharray="5,2" d="M908.8311,-269.7857C912.4258,-249.1978 918.6869,-213.3388 923.0725,-188.2212"/>
<polygon points="926.5517,-188.6431 924.824,-178.1901 919.656,-187.439 926.5517,-188.6431"/>
<text text-anchor="middle" x="922.4492" y="-218.2">0</text>
</g>
<g class="m-node m-flat">
<title>rX</title>
<ellipse cx="856" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="856" y="-155.2">X</text>
</g>
<g class="m-edge">
<title>rP&#45;&gt;rX</title>
<path stroke-dasharray="5,2" d="M900.2644,-271.5462C892.1121,-251.0025 877.0253,-212.9838 866.754,-187.1001"/>
<polygon points="869.8875,-185.5071 862.9457,-177.5032 863.381,-188.0891 869.8875,-185.5071"/>
<text text-anchor="middle" x="887.4492" y="-218.2">1</text>
</g>
<g class="m-node">
<title>rM</title>
<polygon points="812,-304 784.3527,-286 812,-268 839.6473,-286 812,-304"/>
<text text-anchor="middle" x="812" y="-281.2">M</text>
</g>
<g class="m-edge">
<title>rM&#45;&gt;rX</title>
<path stroke-dasharray="5,2" d="M817.2202,-271.0514C824.4146,-250.449 837.5035,-212.9672 846.4685,-187.2947"/>
<polygon points="849.8046,-188.3574 849.7972,-177.7626 843.196,-186.0496 849.8046,-188.3574"/>
<text text-anchor="middle" x="840.4492" y="-218.2">0</text>
</g>
<g class="m-node m-flat">
<title>rN</title>
<ellipse cx="784" cy="-160" rx="27" ry="18"/>
<text text-anchor="middle" x="784" y="-155.2">N</text>
</g>
<g class="m-edge">
<title>rM&#45;&gt;rN</title>
<path stroke-dasharray="5,2" d="M808.4538,-270.042C803.8699,-249.4144 795.8121,-213.1545 790.2042,-187.9189"/>
<polygon points="793.5541,-186.8589 787.9681,-177.8563 786.7208,-188.3775 793.5541,-186.8589"/>
<text text-anchor="middle" x="803.4492" y="-218.2">1</text>
</g>
</g>
</svg>
</div><p>In the <code>error1</code> scenario, there is no source task for the scheduler to start with, and the simplest fix is to add a task <code>S</code> that has no dependents. In the <code>error2</code> scenario, <code>D</code> might be scheduled twice by <code>E</code> through the strong dependency and <code>C</code> through the weak dependency (on returning <code>1</code>). To fix this problem, you can add an auxiliary task <code>D-aux</code> to break the mixed use of strong dependency and weak dependency. In the risky scenario, task <code>X</code> may be raced by <code>M</code> and <code>P</code> if <code>M</code> returns <code>0</code> and P returns <code>1</code>.</p><aside class="m-note m-warning"><h4>Attention</h4><p>It is your responsibility to ensure a written taskflow graph is properly conditioned. We suggest that you <a href="chapter4.html#C4_TaskSchedulingPolicy" class="m-doc">Understand our Task-level Scheduling</a> and infer if task race exists in the execution of your graph.</p></aside></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Taskflow handbook is part of the <a href="https://taskflow.github.io">Taskflow project</a>, copyright © <a href="https://tsung-wei-huang.github.io/">Dr. Tsung-Wei Huang</a>, 2018&ndash;2020.<br />Generated by <a href="https://doxygen.org/">Doxygen</a> 1.8.14 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
